$def with (page)

$var title: $page.name

$putctx("robots", "noindex,nofollow")

$:macros.HiddenSaveButton("addAuthor")

<div id="contentHead">
    $:macros.databarEdit(page)
    $if ctx.user and (ctx.user.is_admin() or ctx.user.is_usergroup_member('/usergroup/super-librarians')):
        <span class="adminOnly right">
            <button type="submit" value="$_('Delete Record')" name="_delete" title="$_('Delete Record')" id="delete" form="addAuthor">$_("Delete Record")</button>
        </span>
    <h1>$_("Edit Author")</h1>
    $if not ctx.user:
        $:render_template("lib/not_logged")
</div>

<div id="contentBody">

    <form id="addAuthor" name="edit" method="post" action="" class="olform books validate">


    <div class="formElement title">
        <div class="formElement">
            <div class="label">
                <label for="name">$_("Name")</label>
                <span class="tip">
                    $:_('Please use natural order. For example: <strong>Leo Tolstoy</strong> not <strong>Tolstoy, Leo</strong>.')
                    <span class="attn"><em>* $_('Required field').</em></span>
                </span>
            </div>
            <div class="input">
                <input type="text" name="author--name" id="name" value="$page.name" class="required"/>
            </div>
        </div>
    </div>

        <div>

            <div id="tabsAddauthor">

                <ul>
                    <li><a href="#about">$_("About")</a></li>
                    <li><a href="#web">$_("Links")</a></li>
                </ul>

                <div id="about">

                    <fieldset class="major collapse">

                        <div class="formElement">
                            <div class="label">
                                <label for="wmd-input">$_("A short bio?")</label>
                                <span class="tip">$_('If you "borrow" information from somewhere, please make sure to cite the source.')</span>
                            </div>
                            <div class="input">
                                <textarea name="author--bio"
                                    class="markdown olform__input--large" id="wmd-input" rows="6">$page.bio</textarea>
                            </div>
                        </div>


                        <div class="formElement contentQuarter" id="birthDate">
                            <div class="label birthLabelAcc">
                                <label for="birth_date">$_("Date of birth")</label>
                            </div>
                            <div class="input birthInputAcc">
                                <input type="text" name="author--birth_date" id="birth_date" value="$page.birth_date"/>
                            </div>
                        </div>

                        <div class="formElement contentQuarter" id="deathDate">
                            <div class="label deathLabelAcc">
                                <label for="death_date">$_("Date of death")</label>
                            </div>
                            <div class="input deathInputAcc">
                                <input type="text" name="author--death_date" id="death_date" value="$page.death_date"/>
                            </div>
                        </div>

                        <div class="formElement contentQuarter">
                            <div class="label tipAcc">
                                <span class="tip">$_('We\'re not storing structured dates (yet) so a date like "21 May 2000" is recommended.')</span>
                            </div>
                        </div>

                        <div class="clearfix"></div>

                        $if page.date:
                            <div class="formElement contentQuarter" id="date">
                                    <div class="label dateLabelAcc">
                                        <label for="date">$_("Date")</label>
                                    </div>
                                    <div class="input deathInputAcc">
                                        <input type="text" name="author--date" id="date" value="$page.date"/>
                                    </div>
                            </div>
                            <div class="formElement contentQuarter">
                                <span class="tip">$_('This is a deprecated field. You can help improve this record by removing this date and populating the "Date of birth" and "Date of death" fields. Thanks!')</span>
                            </div>

                        <div class="clearfix"></div>

                        <div class="formElement">
                            <div class="label">
                                <label for="alternate_names">$_("Does this author go by any other names?")</label>
                                <span class="tip">$_("For example:") Lev Nikolayevich Tolstoy; Yasnaya Polyana</span>
                            </div>
                            <div class="input">
                                <textarea name="author--alternate_names" id="alternate_names" rows="6">$"\n".join(page.alternate_names)</textarea>
                            </div>
                        </div>
                        <div class="label">Identifiers <a href="/help/faq/editing.en#author-identifiers-purpose"><img src="/images/icons/icon_help.png" alt="$_('Author Identifiers Purpose')"/></a> </div>
                $ author_config = get_author_config();
                $ config = ({
                    $ 'Please select an identifier.': _('Please select an identifier.'),
                    $ 'You need to give a value to ID.': _('You need to give a value to ID.'),
                    $ 'ID ids cannot contain whitespace.': _('ID ids cannot contain whitespace.'),
                    $ 'That ID already exists for this author.': _('That ID already exists for this author.'),
                    $ 'Invalid ID format': _('Invalid ID format')
                $ })
                <fieldset class="major" id="authoridentifiers" data-config="$dumps(config)">
                    <legend>$_("ID Numbers")</legend>
                    <div class="formBack">

                        <div id="authorid-errors" class="note" style="display: none"></div>
                        <div class="formElement">
                            <div class="label">
                                <label for="authorselect-id">$_("Do you know any identifiers for this author?")</label>
                                <span class="tip">$_("Like, VIAF?")</span>
                            </div>
                            <div class="input">
                                <table class="identifiers">
                                    <tr id="authoridentifiers-form">
                                        <td align="right">
                                            <select name="name" id="authorselect-id">
                                            $ id_labels = dict((d.name, d.label) for d in author_config.identifiers)
                                            $ id_dict = dict((id.name, id) for id in author_config.identifiers)

                                            <option value="">$_('Select one of many...')</option>
                                            $for id in author_config.identifiers:
                                                <option value="$id.name">$id.label</option>

                                            </select>
                                        </td>
                                        <td>
                                            <input type="text" name="value" id="authorid-value"/>
                                        </td>
                                        <td>
                                            <button type="button" name="add" class="repeat-add larger">$_("Add")</button>
                                        </td>
                                    </tr>
                                    <tbody id="authoridentifiers-display">
                                        <tr id="authoridentifiers-template"  style="display: none;" class="repeat-item">
                                            <td align="right"><strong>{{\$("#authorselect-id").find("option[value='" + name + "']").html()}}</strong></td>
                                            <td data-type="{{name}}">{{value}}
                                              <input type="hidden" name="{{prefix}}remote_ids--{{name}}" value="{{value}}"/>
                                            </td>
                                            <td><a href="javascript:;" class="repeat-remove red plain" title="Remove this identifier">[x]</a></td>
                                        </tr>
                                        <tr>
                                            <td align="right">Open Library</td>
                                            <td>$page.key.split("/")[-1]</td>
                                            <td></td>
                                        </tr>
                                        $ remote_ids = dict(page.remote_ids)
                                        $for (name, value) in remote_ids.items():
                                           $ href = id_dict[name].url.replace('@@@', value)
                                           <tr id="authoridentifiers--$name" data-type="$name" class="repeat-item">
                                            <td align="right"><strong>$id_labels.get(name, name)</strong></td>
                                            <td>$value
                                                <input class="$name" type="hidden" name="author--remote_ids--$name" value="$value"/>
                                            </td>
                                            <td><a href="javascript:;" class="repeat-remove red plain" title="Remove this identifier">[x]</a></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </fieldset>

                        $if page.website:
                            $if ctx.user and ctx.user.is_admin():
                                <div class="formElement adminOnly">
                                    <div class="label">
                                        <label for="uris">$_("Websites")</label>
                                        <span class="tip">$_("Deprecated")</span>
                                    </div>
                                    <div class="input">
                                        <input type="text" name="author--website" id="website" value="$page.website"/>
                                    </div>
                                </div>


                </div>
<!-- /ABOUT -->
                <div id="web">
                    $:render_template("books/edit/web", page, prefix="author--")
                </div>
            </div>

        </div>

        <div class="illustration">
            $:render_template("covers/author_photo", page)
            $:render_template("covers/change", page)
        </div>

            <div class="clearfix"></div>

            <div class="formElement bottom">
                $:macros.EditButtons(comment=page.comment_)
            </div>
    </form>
</div>
